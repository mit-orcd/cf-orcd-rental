{% extends "common/base.html" %}
{% load static %}

{% block title %}Node Instances{% endblock %}

{% block content %}
<h2>Node Instances</h2>
<hr>

<div class="mb-4">
  <strong>Total: {{ gpu_count }} GPU node{{ gpu_count|pluralize }} and {{ cpu_count }} CPU node{{ cpu_count|pluralize }}</strong>
</div>

<h3><i class="fas fa-microchip"></i> GPU Nodes</h3>
<div class="table-responsive">
  <table class="table table-sm table-hover">
    <thead class="thead-light">
      <tr>
        <th scope="col">Type</th>
        <th scope="col">Resource Address</th>
        <th scope="col">Status</th>
        <th scope="col">Rentable</th>
        <th scope="col">Modified</th>
      </tr>
    </thead>
    <tbody>
      {% for node in gpu_nodes %}
      <tr>
        <td><a href="{% url 'coldfront_orcd_direct_charge:gpu-node-detail' node.pk %}">{{ node.node_type.name }}</a></td>
        <td><code>{{ node.associated_resource_address }}</code></td>
        <td>
          {% if node.status == "AVAILABLE" %}
            <span class="badge badge-success">{{ node.get_status_display }}</span>
          {% else %}
            <span class="badge badge-secondary">{{ node.get_status_display }}</span>
          {% endif %}
        </td>
        <td>
          {% if node.is_rentable %}
            <span class="text-success"><i class="fas fa-check"></i> Yes</span>
          {% else %}
            <span class="text-muted"><i class="fas fa-times"></i> No</span>
          {% endif %}
        </td>
        <td>{{ node.modified|date:"M d, Y H:i" }}</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="5" class="text-muted">No GPU nodes defined.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<h3 class="mt-4"><i class="fas fa-server"></i> CPU Nodes</h3>
<div class="table-responsive">
  <table class="table table-sm table-hover">
    <thead class="thead-light">
      <tr>
        <th scope="col">Type</th>
        <th scope="col">Resource Address</th>
        <th scope="col">Status</th>
        <th scope="col">Rentable</th>
        <th scope="col">Modified</th>
      </tr>
    </thead>
    <tbody>
      {% for node in cpu_nodes %}
      <tr>
        <td><a href="{% url 'coldfront_orcd_direct_charge:cpu-node-detail' node.pk %}">{{ node.node_type.name }}</a></td>
        <td><code>{{ node.associated_resource_address }}</code></td>
        <td>
          {% if node.status == "AVAILABLE" %}
            <span class="badge badge-success">{{ node.get_status_display }}</span>
          {% else %}
            <span class="badge badge-secondary">{{ node.get_status_display }}</span>
          {% endif %}
        </td>
        <td>
          {% if node.is_rentable %}
            <span class="text-success"><i class="fas fa-check"></i> Yes</span>
          {% else %}
            <span class="text-muted"><i class="fas fa-times"></i> No</span>
          {% endif %}
        </td>
        <td>{{ node.modified|date:"M d, Y H:i" }}</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="5" class="text-muted">No CPU nodes defined.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}

